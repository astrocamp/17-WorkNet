
{% load static %}
<div x-data="{ isScrolled: false }" @scroll.window="isScrolled = window.scrollY > 0">
  <nav :class="isScrolled ? 'bg-primary bg-opacity-90' : 'bg-transparent'" class="box-border flex fixed top-0 left-0 z-40 items-center w-full min-h-16 md:min-h-28 lg:min-h-28 transition-colors duration-300">
    <div class="absolute left-4 top-1/2 -translate-y-1/2">
      <a href="{% url 'users:index' %}" class="block w-20 md:w-32 lg:w-32 aspect-8/3 bg-center bg-no-repeat bg-contain bg-logo-backend">
      </a>
    </div>
    <div class="w-full" x-data="{ open: false, isMobile: window.innerWidth < 1024 }"
    @resize.window="
            isMobile = window.innerWidth < 1024;
            if (isMobile) { open = false; }
            else { open = true; }"
        x-init="open = !isMobile">
      <div @click="open = !open" class="absolute z-20 right-7 top-1/2 -translate-y-1/2 h-5 md:h-7 w-6 md:w-8 flex flex-col justify-between lg:hidden cursor-pointer">
        <span class="block w-full h-1 bg-white rounded-full"></span>
        <span class="block w-full h-1 bg-white rounded-full"></span>
        <span class="block w-full h-1 bg-white rounded-full"></span>
      </div>
      <div x-show="open" class="w-full md:w-2/6 lg:w-full h-dvh lg:h-auto lg:block absolute top-0 right-0 lg:relative z-10 bg-primary lg:bg-transparent">
        <div class="pt-16 md:pt-24 lg:pt-0 lg:absolute lg:right-4 lg:top-1/2 lg:-translate-y-1/2">
          {% if request.user.is_authenticated %}
          <div class="flex gap-4 flex-col px-4 py-4 bg-secondary lg:bg-transparent lg:px-0 lg:py-0 lg:flex-row">
            <div class="flex relative items-center group">
              <div class="cursor-pointer w-full">
                <h2 class="text-white text-base flex justify-between">
                  <div class="flex-1">
                    <i class="fa-solid fa-user mr-1"></i> {{ request.user }}，您好
                  </div>
                  <div><i class="fa-solid fa-caret-down ml-1"></i></div>
                </h2>
              </div>
              <div class="hidden absolute top-12 left-1/2 p-3 text-center bg-white rounded-xl divide-y shadow-lg -translate-x-1/2 divide-slate-200 lg:group-hover:block">
                {% if request.user.type == 1 %}
                  <a class="block px-2.5 py-2 whitespace-nowrap" href="{% url 'users:info' %}">會員資料</a>
                  <a class="block px-2.5 py-2 whitespace-nowrap" href="{% url 'users:favorites_list' %}">我的職缺收藏</a>
                  <a class="block px-2.5 py-2 whitespace-nowrap" href="{% url 'users:favorites_company_list' %}">喜愛的公司</a>
                  <a class="block px-2.5 py-2 whitespace-nowrap" href="{% url 'resumes:index' %}">我的履歷</a>
                  <a class="block px-2.5 py-2 whitespace-nowrap" href="{% url 'resumes:jobs' %}">應徵紀錄</a>
                {% elif request.user.type == 2 %}
                  <a class="block px-2.5 py-2 whitespace-nowrap" href="{% url 'companies:index' %}">公司資料</a>
                {% endif %}
              </div>
            </div>

            <form action="{% url 'users:sign_out' %}" method="POST" class="hidden lg:block">
              {% csrf_token %}
              <button class="btn btn-error btn-lg min-w-28 border-0 w-full lg:w-auto">登出</button>
            </form>
          </div>
          {% else %}
          <ul class="flex border-b border-[#365f8c] justify-center pb-4 lg:p-0 lg:border-0">
            <li>
              <a class="text-white text-xl btn no-style min-w-28 hover:border-transparent" href="{% url 'users:sign_in' %}">登入</a>
            </li>
            <li>
              <a :class="isScrolled ? 'btn-secondary' : 'btn-primary'" class="text-xl btn btn-primary min-w-28" href="{% url 'users:register' %}">註冊</a>
            </li>
          </ul>
          {% endif %}
        </div>
        <div class="text-base md:text-xl lg:text-xl text-white lg:pl-48">
          <ul class="flex lg:inline-flex lg:gap-11 text-center flex-col lg:flex-row">
            <li>
              <a class="block font-medium py-4 border-b border-[#365f8c] lg:border-0" href="/">首頁</a>
            </li>
            <li>
              <a class="block font-medium py-4 border-b border-[#365f8c] lg:border-0" href="{% url 'companies:index' %}">公司資訊</a>
            </li>
            <li>
              {% if request.user.type == 2 %}
                <a class="block font-medium py-4 border-b border-[#365f8c] lg:border-0" href="{% url 'companies:jobs_index' request.user.company.id %}">職缺</a>
              {% else %}
                <a class="block font-medium py-4 border-b border-[#365f8c] lg:border-0" href="{% url 'jobs:index' %}">職缺</a>
              {% endif %}
            </li>
            <li>
              <a class="block font-medium py-4 border-b border-[#365f8c] lg:border-0" href="{% url 'analytics:index' %}">分析</a>
            </li>
          </ul>
        </div>
        {% if request.user.is_authenticated %}
          <div class="p-4 lg:hidden">
            <form action="{% url 'users:sign_out' %}" method="POST"></form>
              {% csrf_token %}
              <button class="btn btn-error btn-sm md:btn-lg lg:btn-lg min-w-28 border-0 w-full lg:w-auto">登出</button>
            </form>
          </div>
        {% endif %}
      </div>
    </div>
  </nav>
</div>